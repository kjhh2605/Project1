# AI 비용/품질 운영 문서

## 1. 목적
AI 평가 품질을 유지하면서 비용을 예측 가능하게 통제한다.

## 2. 예산 정책
- 일 예산: USD 25
- 월 예산: USD 700
- 경고 임계치: 70% / 90% / 100%
- 임계치 도달 시 자동 조치:
  - 70%: 알림만
  - 90%: Tier 3 평가 비율 축소
  - 100%: 비실시간 재평가 작업 일시 중지

## 3. 비용 최적화 전략
### 3.1 캐스케이드 운영
- 기본: Tier1 → 필요 시 Tier2 → 고난도/이의제기 시 Tier3
- 목표 비율: 60% / 35% / 5%

### 3.2 캐시
- 프롬프트 캐시: 동일 루브릭/문제 템플릿 재사용
- 시맨틱 캐시: 유사 제출 임베딩 매칭
- 캐시 히트 시 응답에 `cache_hit=true` 기록

### 3.3 배치 처리
- 대회/일괄 재평가는 Batch API 우선
- 실시간 채점 경로와 분리하여 SLA 보호

## 4. 품질 지표
- 인간 검수 일치율(샘플링): 목표 85%+
- 평가 재시도율: 3% 미만
- 피드백 만족도(사용자 신고 기반): 월별 추적
- 편향 지표: 언어/문제 난이도별 점수 분포 모니터링

## 5. 운영 프로세스
1. 일일 비용 리포트 점검
2. 주간 품질 샘플 검수(최소 100건)
3. 월간 루브릭/프롬프트 버전 리뷰
4. 이상 징후 시 롤백(이전 프롬프트 버전)

## 6. A/B 테스트 정책
- 실험 단위: 프롬프트 템플릿 또는 캐스케이드 승급 조건
- 성공 기준:
  - 품질 지표 하락 없음
  - 평균 비용 10% 이상 절감 또는 지연 10% 개선
- 실험 종료 후 ADR 기록

## 7. 장애 대응
- LLM API 지연 급증: 타임아웃 축소 + Tier 강등
- 모델 오류율 급증: fallback 모델로 전환
- 비용 급증: 캐시 정책 강화 + Tier3 제한
